{% extends 'chat/home.html' %}
{% block subcontent %}
    <h1>{{ recipient }}</h1>
    {% if not is_friends %}
        <p>You cannot message this user because they are not on your friends list</p>
    {% endif %}

    <div hx-ext="ws" ws-connect="/ws/chat/{{ recipient.id }}/">
        <form id="form" ws-send>
            <input name="message">
        </form>
    </div>

    <form method="POST" action="{% url 'direct_message' recipient.username %}">
        {% csrf_token %}
        {{ form }}
        <button type="submit">Send</button>
    </form>
    {% for group in grouped_messages %}
        <p>{{ group.date|date:'Y-m-d' }}</p>
        {% for msg in group.messages %}
            {% include 'chat/snippets/message.html' with msg=msg %}
        {% endfor %}
    {% endfor %}
{% endblock subcontent %}